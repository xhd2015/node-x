!function(e,n){if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var o=n();for(var t in o)("object"==typeof exports?exports:e)[t]=o[t]}}(globalThis,(()=>(()=>{"use strict";var e={247:function(e,n,o){var t=this&&this.__awaiter||function(e,n,o,t){return new(o||(o=Promise))((function(r,i){function s(e){try{l(t.next(e))}catch(e){i(e)}}function a(e){try{l(t.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?r(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,a)}l((t=t.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.run=void 0;const r=o(81);n.run=function(e,n){return t(this,void 0,void 0,(function*(){const o=r.spawn("bash",[`-e${(null==n?void 0:n.debug)?"x":""}c`,e,"--",...(null==n?void 0:n.args)||[]],{cwd:null==n?void 0:n.cwd,env:Object.assign(Object.assign({},process.env),null==n?void 0:n.env)});return o.stdout.on("data",(e=>process.stdout.write(e))),o.stderr.on("data",(e=>process.stderr.write(e))),new Promise(((e,n)=>{o.on("error",(function(e){n(e)})),o.on("close",(function(o){0!==o?n(new Error(`exit code: ${o}`)):e(o)}))}))}))}},258:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.formatWebpackConfigJS=n.formatTsConfigJSON=n.formatPackageJSON=void 0,n.formatPackageJSON=function(e){return`{\n        "name": "${e||"tmp"}",\n        "version": "0.0.1",\n        "dependencies": {\n        },\n        "scripts": {\n            "build": "webpack --config webpack.config.js --progress --mode=production",\n            "build-dev": "webpack --config webpack.config.js --progress --mode=development"\n        },\n        "devDependencies": {\n            "@babel/cli": "^7.1.0",\n            "@babel/core": "^7.1.0",\n            "@babel/preset-env": "^7.1.0",\n            "@types/node": "^18.11.18",\n            "babel-loader": "^8.1.0",\n            "file-loader": "^6.0.0",\n            "ts-loader": "^9.3.1",\n            "webpack-cli": "^4.10.0"\n        }\n    }\n    `},n.formatTsConfigJSON=function(){return'{\n        // Change this to match your project\n        // "include": [],\n        "compilerOptions": {\n            // Tells TypeScript to read JS files, as\n            // normally they are ignored as source files\n            // "allowJs": true,\n            // Generate d.ts files\n            // "declaration": true,\n            // This compiler run should\n            // only output d.ts files\n            // "emitDeclarationOnly": true,\n            // Types should go into this directory.\n            // Removing this would place the .d.ts files\n            // next to the .js files\n            //   "outDir": "dist"\n            "target": "es6",\n            "lib": [\n                "ES2021",\n                "ES2021.String"\n            ],\n            // "target": "es6",\n            "module": "commonjs",\n            // "module": "ES2015",\n            // "outDir": "src/debug",\n            "moduleResolution": "node",\n            "rootDirs": ["./"]\n        },\n        "exclude": []\n    }'},n.formatWebpackConfigJS=function(){return'const path = require("path");\n    \n    module.exports = {\n      entry: {\n        run: {\n          import: "./run.ts",\n          filename: "run.js",\n        },\n      },\n      output: {\n        path: path.resolve(__dirname, "bin"),\n        libraryTarget: "umd", // for nodejs need this\n        globalObject: "globalThis", // goja only recognize globalThis, not the default global.\n      },\n      module: {\n        rules: [\n          {\n            test: /.ts$/,\n            // exclude: /(node_modules)/,\n            use: {\n              loader: "ts-loader",\n              options: {\n                transpileOnly: true,\n              },\n            },\n          },\n          {\n            test: /.(js)$/,\n            exclude: /(node_modules)/,\n            resolve: {\n              extensions: [".ts", ".js"],\n            },\n            use: {\n              loader: "babel-loader",\n              options: {\n                presets: ["@babel/preset-env"],\n              },\n            },\n          },\n        ],\n      },\n      resolve: {\n        alias: {\n          "@": path.resolve(__dirname, "./"),\n        },\n        extensions: [".ts", ".js"],\n      },\n      target: "node",\n      node:{\n        __filename:true,\n        __dirname:true,  // these two options make the __filename & __dirname correspond to original file name\n      },\n      plugins: [],\n      // devtool: "source-map",\n    };\n    '}},192:function(e,n,o){var t=this&&this.__awaiter||function(e,n,o,t){return new(o||(o=Promise))((function(r,i){function s(e){try{l(t.next(e))}catch(e){i(e)}}function a(e){try{l(t.throw(e))}catch(e){i(e)}}function l(e){var n;e.done?r(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,a)}l((t=t.apply(e,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.run=void 0;const r=o(17),i=o(292),s=o(37),a=o(258),l=o(247),c=o(113),u="true"==process.env.DEBUG;function d(){return t(this,void 0,void 0,(function*(){const[e,...n]=process.argv.slice(2);if(!e)throw new Error("requires script to run");const o=r.resolve(e);if(!r.isAbsolute(o))throw new Error(`failed to make ${e} absolute, the resolved path is ${o}`);if(!(yield i.stat(o)).isFile())throw new Error(`not a file: ${e}`);const t=(0,s.tmpdir)(),d=r.join(t,"nx-sync"),p=r.dirname(o);if(!r.isAbsolute(p))throw new Error(`failed to detect absolute dir of ${e}, the resolved dir is ${p}`);if(p===d||p.startsWith(d))throw new Error(`${e} resides in nx-sync dir: ${d}, try another location`);const f=r.join(d,p);u&&console.log("target dir:",f),yield i.mkdir(f,{recursive:!0});const m=(0,a.formatPackageJSON)("tmp"),h=(0,a.formatTsConfigJSON)(),b=(0,a.formatWebpackConfigJS)(),v="package.json.checksum",g=yield i.readFile(r.join(f,v),{encoding:"utf-8"}).catch((e=>{})),w=(0,c.createHash)("md5").update(m).digest("hex"),y={"run.ts":`import "${o}";`,"package.json":m,[v]:w,"tsconfig.json":h,"webpack.config.js":b};yield Promise.all(Object.keys(y).map((e=>i.writeFile(r.join(f,e),y[e]))));const x=u?"":"&>/dev/null";yield(0,l.run)(`\n    set -e\n    (\n        cd "$TARGET_DIR"\n        if [ $NEED_INSTALL == true ];then npm install ${x} ; fi ;# slow\n        npm run build-dev ${x} ; # dev mode webpack can use build cache\n    )\n    node "$TARGET_DIR/bin/run.js" "$@"\n    `,{debug:u,args:n,env:{TARGET_DIR:f,NEED_INSTALL:String(g!==w)}})}))}n.run=d,d().catch((e=>{console.error(e.message),process.exit(1)}))},81:e=>{e.exports=require("child_process")},113:e=>{e.exports=require("crypto")},292:e=>{e.exports=require("fs/promises")},37:e=>{e.exports=require("os")},17:e=>{e.exports=require("path")}},n={};return function o(t){var r=n[t];if(void 0!==r)return r.exports;var i=n[t]={exports:{}};return e[t].call(i.exports,i,i.exports,o),i.exports}(192)})()));